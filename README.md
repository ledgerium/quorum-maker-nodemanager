# **Quorum Maker Nodemanager**

Quorum-maker-nodemanager repository contains the server side code for the quorum-maker application. It is implemented in the Go language. It internally communicates with Ledgerium node via JSON-RPC over HTTP.

* All the transactions were sent from coinbase and hardcoded empty password using the RPC endpoint sendTransaction. As it is not secure to hardcode the password, all transactions sent are now signed with the private key obtained from setup.conf file and submitted through RPC endpoint sendSignedTransaction. 

* Quorum maker deploys the network manager contract publicly to keep track of all the nodes in the network and to also note the constellation/tessera public key of a particular node to be used for making private transactions. This contract is deployed when the application starts and the contract address is written to the setup.conf file. When the application restarts it is picked up from the setup.conf file. In the latest version NetworkManager contract is deployed in the genesis block at the address 0x-- and is written to setup.conf file.

* The location for the configuration file and contract abi is updated to quorum-maker/setup.conf and quorum-maker/contracts and these can be configured through command line arguments.

* Timestamp calculation was done assuming RAFT consensus is used i.e block timestamp is in nanoseconds. Since IBFT consensus is used in ledgerium setup and block timestamp is in seconds, all the timestamp calculations are updated.

The executable (quorum-maker-nodemanager) is generated with the command Go build and can be run with a few command line arguments. 
1. The endpoint of the geth node to connect to 
2. The port number the nodemanager application listens on
3. The path to the file containing geth logs
4. The path to the file containing constellation/tessera logs
5. The path to the file containing initial configuration parameters.

It exposes Rest APIs for the quorum-maker UI to consume, below is the list of APIs exposed 

| Endpoint              | Type | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|-----------------------|------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| /block                | GET  | This endpoint returns a list of latest n blocks if the query string parameter number is equal to n. If the query string parameter reference is provided with query string parameter number equal to n, then n blocks starting before (reference â€“ 1) is returned                                                                                                                                                                                                                                                                                                                 |
| /block/{block_no}     | GET  | This endpoint returns the details of a particular block based on the block number                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| /txn                  | GET  | This endpoint returns a list of latest n transactions if the query string parameter number is equal to n                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| /txn/{txn_hash}       | GET  | This endpoint gets the transaction details of a transaction based on the hash. If txn_hash is sent as "pending" it returns a list of all pending transactions                                                                                                                                                                                                                                                                                                                                                                                                                    |
| /txnrcpt/{txn_hash}   | GET  | This endpoint gets the transaction receipt details of a transaction based on hash                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| /txnsearch/{txn_hash} | GET  | This endpoint returns details of a particular transaction based on transaction hash alongside its corresponding block details for displaying the corresponding block information of the queried transaction on UI                                                                                                                                                                                                                                                                                                                                                                |
| /latestBlock          | GET  | This endpoint the latest block number and the difference between present time and the time of creation of the block                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| /peer                 | GET  | This endpoint returns a combination of admin.nodeInfo and certain other details such as current node name, node count, active status, IP, RPC port, raft role, raft ID, blocknumber, pending transaction count as well as the genesis file                                                                                                                                                                                                                                                                                                                                       |
| /peer/{peer_id}       | GET  | This endpoint returns the information gleaned from admin.peers but filtered by enode-id of a particular peer for displaying the pop up from the node table                                                                                                                                                                                                                                                                                                                                                                                                                       |
| /getNodeList          | GET  | This endpoint returns the Name, Role, Public Key, Enode, IP address, Blockchain ID (Raft ID), Geth Health (Active/Inactive) of all participants in the network by querying the Network Manager contract                                                                                                                                                                                                                                                                                                                                                                          |
| /deployContract       | GET  | Multiple contracts can be uploaded via multipart file upload through this endpoint. The source .sol files are compiled using solc and subsequently deployed. The deployment is done either publicly or privately. In the case of private deployment, the public keys of the concerned parties are sent from UI. The list of network participants and their corresponding public keys are fetched using a REST API call. Error messages that occur from compilation failures are also displayed on UI. All the deployed contracts are easily accessible from the UI in the format |
| /mailserver           | GET  | This endpoint helps the user configure the SMTP Server Address, Port Number, Recipient List and Username of the Mail Server for subscribing to the Quorum Maker Email Notification Service                                                                                                                                                                                                                                                                                                                                                                                       |
| /chartData            | GET  | This endpoint returns the number of blocks and transactions mined in the last 10 minutes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| /contractList         | GET  | This endpoint returns the contract address, contract name, ABI, sender address, contract type (public/private), creation time and an optional description of all contracts deployed on the blockchain                                                                                                                                                                                                                                                                                                                                                                            |
| /createAccount        | POST | This endpoint allows the creation of a new ethereum account                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| /getAccounts          | GET  | This endpoint returns a list of all ethereum accounts present on a node along with their balances and also adds an indicator for coinbase                                                                                                                                                                                                                                                                                                                                                                                                                                        |
